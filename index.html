<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>Poli Grupo 2</title>
<link rel="manifest" href="./manifest.json">
<meta name="theme-color" content="#F1F6F9">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="apple-touch-icon" href="https://i.postimg.cc/g2D57d2d/43-sin-titulo-20260107215026.png">
<link rel="icon" href="https://i.postimg.cc/g2D57d2d/43-sin-titulo-20260107215026.png">
<style>
:root {
--accent: #0081C9; --bg: #F1F6F9; --dark: #212A3E; --danger: #FF6464;
--success: #54B435; --warning: #FFB100; --card-bg: #ffffff; --text-color: #212A3E;
}
[data-theme="dark"] {
--bg: #121212; --dark: #000000; --card-bg: #1E1E1E; --text-color: #E0E0E0;
}
* { -webkit-tap-highlight-color: transparent; }
@media (hover: none) and (pointer: coarse) {
*:focus { outline: none; }
}
body {
font-family: 'Segoe UI', sans-serif;
background: var(--bg);
margin: 0;
color: var(--text-color);
transition: background-color 0.4s, color 0.4s;
padding-top: env(safe-area-inset-top);
touch-action: pan-y;
}
#menu-overlay {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: rgba(0, 0, 0, 0.08);
z-index: 1999;
opacity: 0;
visibility: hidden;
transition: opacity 0.2s ease;
}
body.menu-open #menu-overlay {
opacity: 1;
visibility: visible;
}
/* ‚úÖ Men√∫ fluido con transform */
.sidebar {
position: fixed;
top: 0;
left: 0;
width: 280px;
height: 100%;
background: linear-gradient(
to bottom,
rgba(241, 246, 249, 0.4) 0%,
rgba(241, 246, 249, 0.25) 100%
);
backdrop-filter: blur(10px);
-webkit-backdrop-filter: blur(3px);
transform: translateX(-100%);
transition: transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
will-change: transform;
color: #222;
z-index: 2000;
padding: 20px;
padding-top: calc(20px + env(safe-area-inset-top, 0px));
box-sizing: border-box;
overflow-y: auto;
border-right: 1px solid rgba(255, 255, 255, 0.25);
box-shadow: 2px 0 12px rgba(0, 0, 0, 0.1);
-webkit-font-smoothing: antialiased;
}
[data-theme="dark"] .sidebar {
background: linear-gradient(
to bottom,
rgba(18, 18, 18, 0.5) 0%,
rgba(18, 18, 18, 0.35) 100%
);
color: #f0f0f0;
border-right-color: rgba(255, 255, 255, 0.15);
box-shadow: 2px 0 12px rgba(0, 0, 0, 0.2);
}
.sidebar.open {
transform: translateX(0);
}
/* ‚úÖ Correcci√≥n de alineaci√≥n en el header */
.sidebar-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 20px;
flex-wrap: nowrap;
min-height: 50px;
}
.sidebar-header button {
background: none;
border: none;
font-size: 24px;
cursor: pointer;
flex-shrink: 0;
width: 40px;
height: 40px;
display: flex;
align-items: center;
justify-content: center;
color: var(--accent);
}
.sidebar-header h2 {
font-size: 28px;
margin: 0;
}
/* Agrandar el bot√≥n de cerrar */
#close-menu {
font-size: 30px !important;
width: auto;
min-width: 44px;
height: auto;
min-height: 44px;
display: flex;
align-items: center;
justify-content: center;
}
.menu-fab {
position: fixed;
bottom: 20px;
left: 20px;
z-index: 1500;
background: var(--accent);
color: white;
border: none;
padding: 15px 25px;
border-radius: 50px;
font-weight: bold;
cursor: pointer;
box-shadow: 0 4px 15px rgba(0,0,0,0.3);
transition: all 0.2s ease;
}
.menu-fab:hover { transform: scale(1.05); box-shadow: 0 6px 20px rgba(0,0,0,0.4); }
.menu-fab:active { transform: scale(0.95); }
.main-content { padding: 20px; max-width: 600px; margin: 0 auto; padding-bottom: 100px; }
.categoria-box {
background: var(--card-bg); padding: 15px; border-radius: 15px; margin-bottom: 15px;
box-shadow: 0 2px 5px rgba(0,0,0,0.05); border: 1px solid rgba(0,0,0,0.1);
transition: background-color 0.4s, border-color 0.4s;
}
h3 { margin-top: 0; color: var(--accent); border-bottom: 2px solid var(--accent); padding-bottom: 5px; }
.producto-row { display: flex; align-items: center; gap: 8px; margin-bottom: 12px; }
.producto-row span { font-size: 14px; white-space: nowrap; min-width: 80px; }
select { padding: 10px; border-radius: 8px; border: 1px solid #ddd; flex: 1; background: var(--card-bg); color: var(--text-color); min-width: 0; }
.add-btn, .fast-btn, .btn-qty, .btn-footer {
transition: all 0.2s ease;
}
.add-btn {
background: var(--accent);
color: white;
border: none;
cursor: pointer;
font-weight: bold;
border-radius: 8px;
height: 42px;
width: 48px;
font-size: 20px;
flex-shrink: 0;
}
.add-btn.activo {
background: #005a87 !important; /* azul oscuro */
box-shadow: 0 2px 6px rgba(0, 90, 135, 0.4) !important;
}
.add-btn:hover { transform: scale(1.05); box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
.add-btn:active { transform: scale(0.95); }

/* ‚úÖ Botones r√°pidos fijos: tama√±o constante y alineaci√≥n estable */
.fast-btn.fixed-size {
  min-width: 130px;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding: 0 8px;
  box-sizing: border-box;
  font-size: 13px;
}

.fast-btn-group.fixed-row {
  display: flex;
  gap: 10px;
  justify-content: space-between;
  flex-wrap: nowrap;
}
/* ‚úÖ Estilo para fast-btn activo */
.fast-btn.activo {
background: #005a87 !important; /* mismo azul oscuro */
box-shadow: 0 2px 6px rgba(0, 90, 135, 0.4) !important;
}

.fast-btn-group { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 10px; }
.fast-btn {
  background: var(--accent);
  color: white;
  border: none;
  padding: 10px;
  border-radius: 10px;
  font-weight: bold;
  cursor: pointer;
  flex: 1;
  font-size: 13px;
  white-space: nowrap;
  text-align: center;
}
.fast-btn:hover { transform: scale(1.03); box-shadow: 0 3px 6px rgba(0,0,0,0.2); }
.fast-btn:active { transform: scale(0.98); }
.ticket {
background: var(--card-bg); padding: 20px; border-radius: 20px; margin-top: 25px;
border: 2px solid var(--accent); transition: background-color 0.4s, border-color 0.4s;
}
.item-pedido {
display: flex; justify-content: space-between; align-items: center;
padding: 12px 0; border-bottom: 1px dashed #ccc;
}
.controles {
display: flex; align-items: center; gap: 12px; justify-content: flex-end; min-width: 140px;
}
.btn-qty {
background: var(--accent);
color: white;
border: none;
cursor: pointer;
font-weight: bold;
border-radius: 50%;
width: 34px;
height: 34px;
font-size: 20px;
display: flex;
align-items: center;
justify-content: center;
flex-shrink: 0;
}
.btn-qty:hover { transform: scale(1.1); }
.btn-qty:active { transform: scale(0.95); }
.qty-num { font-weight: bold; font-size: 16px; min-width: 20px; text-align: center; }
.item-info { flex: 1; padding-right: 10px; }
.item-subtotal { font-weight: bold; min-width: 70px; text-align: right; }
.nota-mesa {
width: 100%; padding: 10px; margin-top: 10px; border-radius: 8px;
box-sizing: border-box; border: 1px solid var(--warning);
background: rgba(255, 177, 0, 0.1); color: var(--text-color);
font-family: inherit; resize: none;
}
.total-box {
background: var(--dark); color: white; padding: 20px; border-radius: 15px;
display: flex; justify-content: space-between; font-size: 22px; font-weight: bold; margin-top: 20px;
transition: background-color 0.4s;
}
.btn-footer {
width: 100%;
padding: 15px;
border: none;
border-radius: 12px;
font-weight: bold;
cursor: pointer;
margin-top: 10px;
color: white;
font-size: 16px;
background: var(--success);
}
.mesa-item {
background: #394867; color: white; padding: 12px; border-radius: 10px;
margin-bottom: 10px; cursor: pointer; border-left: 5px solid transparent;
opacity: 0;
transform: translateY(10px);
animation: popIn 0.4s forwards;
}
.mesa-item.cobrada {
border-left-color: var(--danger); background: #4b1d1d;
}
.tiempo-badge {
font-size: 0.7rem; background: rgba(255,255,255,0.2); padding: 2px 6px;
border-radius: 4px; float: right;
}
.modal {
position: fixed; top: 0; left: 0; width: 100%; height: 100%;
background: rgba(0,0,0,0.8); z-index: 3000;
display: flex; align-items: center; justify-content: center;
}
.modal-content {
background: var(--card-bg); padding: 25px; border-radius: 20px;
width: 90%; max-width: 400px; color: var(--text-color);
}
.hidden { display: none !important; }
/* ‚úÖ Estilo de foco para la barra de b√∫squeda */
#search-container-compact:focus-within > div {
border-color: #00C9FF !important;
box-shadow: 0 0 0 2px rgba(0, 201, 255, 0.2);
}

/* ‚úÖ Estilo mejorado para selects en foco */
select {
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

select:focus {
    outline: none;
    border-color: #00C9FF !important;
    box-shadow: 0 0 0 2px rgba(0, 201, 255, 0.25) !important;
}

@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
@keyframes popIn { to { opacity: 1; transform: translateY(0); } }
</style>
</head>
<body data-theme="light">
<button class="menu-fab" onclick="toggleMenu()">üèñÔ∏è Ver Mesas</button>
<aside class="sidebar" id="sidebar">
<div class="sidebar-header">
<h2 style="margin:0;">
<img src="https://i.postimg.cc/76L71FK9/round-pushpin-1f4cd-(1).png" alt="üìç" style="width:28px; vertical-align:-2px;"> Poli 2
</h2>
<button id="theme-toggle" onclick="toggleTheme()"></button>
<button id="close-menu" onclick="toggleMenu()">‚úï</button>
</div>
<button class="btn-footer" style="background:var(--accent); margin-bottom:20px;" onclick="crearMesa()">+ Nueva Mesa</button>
<div id="lista-mesas"></div>
<hr style="opacity:0.2; margin:20px 0;">
<button class="btn-footer" style="background:var(--success)" onclick="verCierreCaja()">üìä Cierre de Caja</button>
</aside>
<main class="main-content">
<div id="pantalla-vacia" style="text-align:center; margin-top:80px;">
<img src="https://i.postimg.cc/h4Nq8SXn/42-sin-titulo-20260107214826.png" alt="Logo" style="width:250px; border-radius:20px;">
<h2>
Bienvenido a Poli grupo 2
<img src="https://i.postimg.cc/1tTBYGYg/round-pushpin-1f4cd.png" alt="‚òÄÔ∏è" style="width:24px; vertical-align:-3px; margin-left:5px;">
</h2>
</div>
<div id="area-operativa" class="hidden">
<h1 id="titulo-mesa" style="text-align:center;">Mesa</h1>
<!-- ‚úÖ Barra de b√∫squeda p√≠ldora profesional -->
<div id="search-container-compact" style="
display: none;
margin: 12px 16px 16px 16px;
">
<div style="
display: flex;
align-items: center;
background: var(--card-bg);
border: 1px solid rgba(0, 129, 201, 0.3);
border-radius: 50px;
padding: 0 16px;
height: 48px;
transition: border-color 0.2s ease;
"
onclick="document.getElementById('search-input-compact').focus()">
<span style="
color: #00C9FF;
font-size: 18px;
margin-right: 12px;
width: 20px;
text-align: center;
">üîç</span>
<input type="text" id="search-input-compact"
placeholder="Buscar comidas o bebidas..."
style="
flex: 1;
border: none;
background: transparent;
color: var(--text-color);
font-size: 15px;
outline: none;
padding: 0;
height: 100%;
"
oninput="filterSearchCompact()"
onblur="setTimeout(() => document.getElementById('search-results-compact').style.display = 'none', 200)"
>
</div>
<div id="search-results-compact" style="
display: none;
background: var(--card-bg);
border-radius: 12px;
box-shadow: 0 4px 20px rgba(0,0,0,0.15);
max-height: 280px;
overflow-y: auto;
margin-top: 8px;
border: 1px solid rgba(0,129,201,0.3);
"></div>
</div>
<!-- Contenido de categor√≠as -->
<div class="categoria-box">
<h3>
<img src="https://i.postimg.cc/Yvym372n/hamburger-1f354.png" alt="üçî" style="width:22px; vertical-align:-4px;"> Comidas
</h3>
<div class="producto-row">
<span>
<img src="https://i.postimg.cc/K1sgNbc9/french-fries-1f35f.png" alt="üçü" style="width:18px; vertical-align:-3px;"> Papas:
</span>
<select id="papas-select">
<option value="Papas Cono,4000">Cono $4000</option>
<option value="Bandeja Com√∫n,6000">Bandeja Com√∫n $6000</option>
<option value="Bandeja Cheddar,7000">Bandeja Cheddar $7000</option>
</select>
<button class="add-btn" onclick="agregarDeSelect('papas-select')">+</button>
</div>
  
<div class="producto-row">
<span>
<img src="https://i.postimg.cc/Yvym372n/hamburger-1f354.png" alt="üçî" style="width:18px; vertical-align:-3px;"> Hamburg.:
</span>
<select id="hamburg-select">
<option value="Hamburguesa Simple,5000">Simple $5000</option>
<option value="Hamburguesa Completa,7000">Completa $7000</option>
</select>
<button class="add-btn" onclick="agregarDeSelect('hamburg-select')">+</button>
</div>

<div class="producto-row">
<span>
<img src="https://i.postimg.cc/FYnJZvFV/slice-of-pizza-1f355.png" alt="üçï" style="width:18px; vertical-align:-3px;"> Pizzas:
</span>
<select id="pizza-select">
<option value="Pizza Com√∫n,9000">Com√∫n $9000</option>
<option value="Media Pizza Com√∫n,6000">Media Com√∫n $6000</option>
<option value="Pizza Especial,11000">Especial $11000</option>
<option value="Media Pizza Especial,7000">Media Especial $7000</option>
<option value="Pizza Calabresa,12000">Calabresa $12000</option>
<option value="Media Pizza Calabresa,7000">Media Calabresa $7000</option>
<option value="Pizza Provenzal,11000">Provenzal $11000</option>
<option value="Media Pizza Provenzal,7000">Media Provenzal $7000</option>
<option value="Pizza Napolitana,11000">Napolitana $11000</option>
<option value="Media Pizza Napolitana,7000">Media Napolitana $7000</option>
</select>
<button class="add-btn" onclick="agregarDeSelect('pizza-select')">+</button>
</div>
<div class="producto-row">
<span>
<img src="https://i.postimg.cc/fVg0KsWv/sandwich-1f96a.png" alt="ü•™" style="width:18px; vertical-align:-3px;"> S√°ndwich:
</span>
<select id="sand-select">
<!-- Milanesas de Carne -->
<option value="Mila Carne Simple,8000">mila carne Simple $8000</option>
<option value="Mila Carne Completa,10000">mila carne Completa $10000</option>
<!-- Milanesas de Pollo -->
<option value="Mila Pollo Simple,8000">mila pollo Simple $8000</option>
<option value="Mila Pollo Completa,10000">mila pollo Completa $10000</option>
<!-- Otros -->
<option value="S. Miga,5000">Miga $5000</option>
<option value="Carlitos,6000">Carlitos $6000</option>
<option value="Triples,7000">Triples $7000</option>
</select>
<button class="add-btn" onclick="agregarDeSelect('sand-select')">+</button>
</div><div class="producto-row">
<span>ü•ß Tartas:</span>
<select id="tarta-select">
<option value="Tarta J&Q,11000">J&Q Entera $11000</option>
<option value="1/2 Tarta J&Q,7000">J&Q Media $7000</option>
<option value="Tarta Verdura,11000">Verdura Entera $11000</option>
<option value="1/2 Tarta Verdura,7000">Verdura Media $7000</option>
<option value="Tarta Pollo,12000">Pollo Entera $12000</option>
<option value="1/2 Tarta Pollo,8000">Pollo Media $8000</option>
</select>
<button class="add-btn" onclick="agregarDeSelect('tarta-select')">+</button>
</div>
<div class="producto-row">
<span>
<img src="https://i.postimg.cc/YC7LcnF4/dumpling-1f95f.png" alt="ü•ü" style="width:18px; vertical-align:-3px;"> Empan.:
</span>


<select id="empa-select">
  <option value="Carne,1500">Carne $1500</option>
 <!--<option value="Pollo,1500">Pollo $1500</option>-->
  <option value="Media Docena Carne,9000">Media Docena Carne $9000</option>
 <!-- <option value="Media Docena Pollo,9000">Media Docena Pollo $9000</option>-->
  <option value="Docena Carne,18000">Docena Carne $18000</option>
 <!--<option value="Docena Pollo,18000">Docena Pollo $18000</option>-->
</select>

<button class="add-btn" onclick="agregarDeSelect('empa-select')">+</button>
</div>

<div class="producto-row">
<span>
<img src="https://i.postimg.cc/P5HvG3DC/hot-dog-1f32d.png" alt="üå≠" style="width:18px; vertical-align:-3px;"> Panchos:
</span>
<select id="pancho-select">
<option value="Pancho,1500">Simple $1500</option>
<option value="Combo Pancho+Lata,3000">Combo (+Lata) $3000</option>
</select>
<button class="add-btn" onclick="agregarDeSelect('pancho-select')">+</button>
</div>

<!-- Primera fila: Dona, T. Frita, Girasoles -->
<!-- Botones r√°pidos corregidos -->
<div class="fast-btn-group fixed-row">
  <button class="fast-btn fixed-size" data-product="Dona" onclick="agregarProd('Dona', 700)">
    <img src="https://i.postimg.cc/zGNHmthb/doughnut-1f369.png" alt="üç©" style="width:16px; vertical-align:-3px;"> Dona $700
  </button>
  <button class="fast-btn fixed-size" data-product="Torta Frita" onclick="agregarProd('Torta Frita', 500)">
    <img src="https://i.postimg.cc/3wmKKYHT/torta-firta.png" alt="ü•Ø" style="width:20px; vertical-align:-5.5px;"> T. Frita $500
  </button>
</div>
<div class="fast-btn-group fixed-row" style="margin-top: 8px;">


  
<!-- Combos arriba, Girasoles abajo -->
<div style="display:flex; flex-wrap:wrap; gap:8px; width:100%;">
  
  <!-- Fila 1: Combos -->
  <div style="display:flex; gap:8px; flex-wrap:wrap; width:100%; margin-bottom:6px;">
    <button class="fast-btn fixed-size" data-product="Picada" onclick="agregarProd('Combo 1:Pizza com√∫n + Tarta J&Q', 18000)">
      <img src="https://i.postimg.cc/FYnJZvFV/slice-of-pizza-1f355.png" alt="üçï" style="width:23px; vertical-align:-7px;"> pizza + tartaJ&Q $18k
    </button>

    <button class="fast-btn fixed-size" data-product="Picada" onclick="agregarProd('Combo 2: Pizza Especial + Papas', 15000)">
      <img src="https://i.postimg.cc/FYnJZvFV/slice-of-pizza-1f355.png" alt="üçï" style="width:23px; vertical-align:-7px;"> pizza esp + papas $15k
    </button>
  </div>

  <!-- Fila 2: Girasoles -->
  <button class="fast-btn fixed-size" data-product="Girasoles" onclick="agregarProd('Picada', 20000)">
   üç± Picada 20k
  </button>

</div>
</div>
</div>
<div class="categoria-box">
<h3>
<img src="https://i.postimg.cc/wjzRKfNN/cup-with-straw-1f964.png" alt="üçπ" style="width:22px; vertical-align:-4px;"> Bebidas
</h3>
<div class="producto-row">
<span>
<img src="https://i.postimg.cc/fLMkpJSg/46-sin-titulo-20260108112849.png" alt="ü•§" style="width:18px; vertical-align:-3px;"> Pepsi/7up:
</span>
<select id="gaseosa-select">
<option value="Pepsi 500ml,2000">Pepsi 500ml $2000</option>
<option value="Pepsi Lata,2000">Pepsi Lata $2000</option>
<option value="Pepsi 1.5L,4000">Pepsi 1.5L $4000</option>
<option value="7up 500ml,2000">7up 500ml $2000</option>
<option value="7up Lata,2000">7up Lata $2000</option>
<option value="7up 1.5L,4000">7up 1.5L $4000</option>
<option value="Mirinda 1.5L,3500">Mirinda 1.5L $3500</option>
<option value="H2O 1.5L,3500">H2O 1.5L $3500</option>
<option value="Paso Toros 1.5L,4000">P. Toros 1.5L $4000</option>
</select>
<button class="add-btn" onclick="agregarDeSelect('gaseosa-select')">+</button>
</div>
<div class="producto-row">
<span>üç∫ Cervezas:</span>
<select id="birra-select">
<option value="Quilmes 1L,4500">Quilmes 1L $4500</option>
<option value="Quilmes Negra 1L,4500">Quilmes Negra $4500</option>
<option value="Budweiser 1L,5000">Budweiser 1L $5000</option>
<option value="Lata Budweiser,2000">Lata Bud $2000</option>
<option value="Brahma 1L,4500">Brahma 1L $4500</option>
<option value="Corona 330ml,3500">Corona 330ml $3500</option>
<option value="Stella 1L,6000">Stella 1L $6000</option>
<option value="Lata Stella,3500">Lata Stella $3500</option>


</select>
<button class="add-btn" onclick="agregarDeSelect('birra-select')">+</button>
</div>
<div class="producto-row">
<span>
<img src="https://i.postimg.cc/Jz8Hw6XB/droplet-1f4a7.png" alt="üíß" style="width:18px; vertical-align:-3px;"> Agua/Gator.:
</span>
<select id="agua-select">
<option value="Agua Mineral 500ml,1500">Agua 500ml $1500</option>
<option value="Agua Mineral 1.5L,2500">Agua 1.5L $2500</option>
<option value="AguaFrut 1.5L,3500">AguaFrut 1.5L $3500</option>
<option value="Gatorade,3000">Gatorade $3000</option>
<option value="Baggio 250ml,600">Baggio 250ml $600</option>
</select>
<button class="add-btn" onclick="agregarDeSelect('agua-select')">+</button>
</div>
<div class="producto-row">
<span>
<img src="https://i.postimg.cc/RWbnRmC1/wine-glass-1f377.png" alt="üç∑" style="width:18px; vertical-align:-3px;"> Vinos/Jarra:
</span>
<select id="vino-select">
<option value="Nanpe Tinto,4000">Nanpe Tinto $4000</option>
<option value="Alma Dada,8000">Alma Dada $8000</option>
<option value="Chacabuco Blanco,8000">Chacabuco B. $8000</option>
<option value="Sidra,9000">Sidra $9000</option>
<option value="Jarra Fernet,8000">Jarra Fernet $8000</option>
<option value="Jarra Gancia,6000">Jarra Gancia $6000</option>
</select>
<button class="add-btn" onclick="agregarDeSelect('vino-select')">+</button>
</div>
<div class="fast-btn-group">
<button class="fast-btn" data-product="Jarra Hielo" onclick="agregarProd('Jarra Hielo', 1000)">
üßä Jarra Hielo $1000
</button>
<button class="fast-btn" data-product="Agua Caliente" onclick="agregarProd('Agua Caliente', 500)">
üßâ Agua Caliente $500
</button>
</div>
</div>
<div class="categoria-box">
<h3>
<img src="https://i.postimg.cc/681G0K6C/ios-18-4-2762.png" alt="üçì" style="width:22px; vertical-align:-4px;"> Postres
</h3>
<div class="producto-row">
<span>
<img src="https://i.postimg.cc/4YFh5G4F/soft-ice-cream-1f366.png" alt="üç¶" style="width:18px; vertical-align:-3px;"> Helados:
</span>
<select id="helado-select">
  <option value="Palito de Agua,600">Palito de Agua $600</option>
  <option value="Bomb√≥n,1500">Bomb√≥n $1500</option>
  <option value="Alfajor,2000">Alfajor $2000</option>
  <option value="Cono,2500">Cono $2500</option>
  <option value="Tacita,2500">Tacita $2500</option>
  <option value="Juguito Congelado,300">Juguito Congelado $300</option>
</select>
<button class="add-btn" onclick="agregarDeSelect('helado-select')">+</button>
</div>
<div class="producto-row">
<span>
<img src="https://i.postimg.cc/mrCbbBG4/ensalada-de-fruta.png" alt="üçß" style="width:24px; vertical-align:-5px;"> tiramis√∫/chocotorta:
</span>
<select id="fruit-select">
<option value="Tiramis√∫,2000"> Tiramis√∫ $2000</option>
<option value="Chocotorta,2500"> Chocotorta $2500</option>
</select>
<button class="add-btn" onclick="agregarDeSelect('fruit-select')">+</button>
</div>

<!--
<div class="producto-row">
<span>
<span style="font-size:18px; vertical-align:-3px;">üçπ</span> Batidos:
</span>
<select id="batido-select">
<option value="Batido Banana,5000">Banana $5000</option>
<option value="Batido Frutilla,5000">Frutilla $5000</option>
</select>
<button class="add-btn" onclick="agregarDeSelect('batido-select')">+</button>
</div>
-->
</div>
<div class="ticket">
<h3>üìù Mesa <span id="nombre-mesa-ticket"></span></h3>
<textarea id="nota-input" class="nota-mesa" placeholder="Notas del pedido (Ej: Papas sin sal)..." onchange="guardarNota()"></textarea>
<div id="lista-pedidos"></div>
<div class="total-box"><span>TOTAL</span><span id="total-precio">$0</span></div>
<div id="btn-container"></div>
</div>
</div>
</main>
<div id="menu-overlay" class="hidden" onclick="toggleMenu()"></div>
<div id="modal-caja" class="modal hidden">
<div class="modal-content">
<h3 style="text-align:center;">üìä Cierre de Caja</h3>
<div id="caja-detalle" style="max-height:300px; overflow-y:auto; margin-bottom:15px;"></div>
<h2 id="caja-total" style="text-align:center; color:var(--success);"></h2>
<button class="btn-footer" style="background:var(--accent)" onclick="document.getElementById('modal-caja').classList.add('hidden')">Cerrar</button>
<button class="btn-footer" style="background:var(--danger); opacity:0.7;" onclick="reiniciarCaja()">Reiniciar D√≠a</button>
</div>
</div>
<script>
if ('serviceWorker' in navigator) {
window.addEventListener('load', () => { navigator.serviceWorker.register('./sw.js'); });
}
let mesas = JSON.parse(localStorage.getItem('poli_vFinal')) || {};
let historial = JSON.parse(localStorage.getItem('poli_historial')) || [];
let mesaActual = null;
let cierreEnviado = false;
// === SWIPE MEJORADO ===
let touchStartX = 0;
let touchEndX = 0;
document.body.addEventListener('touchstart', (e) => {
touchStartX = e.changedTouches[0].clientX;
});
document.body.addEventListener('touchend', (e) => {
touchEndX = e.changedTouches[0].clientX;
const diff = touchEndX - touchStartX;
const sidebar = document.getElementById('sidebar');
const isOpen = sidebar.classList.contains('open');
if (!isOpen && diff > 40 && touchStartX < 100) {
toggleMenu();
}
else if (isOpen && diff < -40) {
toggleMenu();
}
});
// === B√öSQUEDA COMPACTA ===
let allProductsCompact = [];
function initializeSearchCompact() {
allProductsCompact = [
// Comidas - Papas
{ name: 'Papas Cono', price: 4000, category: 'papas' },
{ name: 'Bandeja Com√∫n', price: 6000, category: 'papas' },
{ name: 'Bandeja Cheddar', price: 7000, category: 'papas' },
// Comidas - Hamburguesas
{ name: 'Hamburguesa Simple', price: 6000, category: 'hamburguesa' },
{ name: 'Hamburguesa Completa', price: 9000, category: 'hamburguesa' },
// Comidas - Pizzas
{ name: 'Pizza Com√∫n', price: 9000, category: 'pizza' },
{ name: 'Media Pizza Com√∫n', price: 6000, category: 'pizza' },
{ name: 'Pizza Especial', price: 11000, category: 'pizza' },
{ name: 'Media Pizza Especial', price: 7000, category: 'pizza' },
{ name: 'Pizza Calabresa', price: 12000, category: 'pizza' },
{ name: 'Media Pizza Calabresa', price: 7000, category: 'pizza' },
{ name: 'Pizza Provenzal', price: 11000, category: 'pizza' },
{ name: 'Media Pizza Provenzal', price: 7000, category: 'pizza' },
{ name: 'Pizza Napolitana', price: 11000, category: 'pizza' },
{ name: 'Media Pizza Napolitana', price: 7000, category: 'pizza' },
// Comidas - S√°ndwiches
{ name: 'Mila Carne Simple', price: 8000, category: 's√°ndwich' },
{ name: 'Mila Carne Completa', price: 10000, category: 's√°ndwich' },
{ name: 'Mila Pollo Simple', price: 8000, category: 's√°ndwich' },
{ name: 'Mila Pollo Completa', price: 10000, category: 's√°ndwich' },
{ name: 'S. Miga', price: 5000, category: 's√°ndwich' },
{ name: 'Carlitos', price: 6000, category: 's√°ndwich' },
{ name: 'Triples', price: 7000, category: 's√°ndwich' },
// Comidas - Tartas
{ name: 'Tarta J&Q Entera', price: 11000, category: 'tarta' },
{ name: 'Tarta J&Q Media', price: 7000, category: 'tarta' },
{ name: 'Tarta Verdura Entera', price: 11000, category: 'tarta' },
{ name: 'Tarta Verdura Media', price: 7000, category: 'tarta' },
{ name: 'Tarta Pollo Entera', price: 12000, category: 'tarta' },
{ name: 'Tarta Pollo Media', price: 8000, category: 'tarta' },
// Comidas - Empanadas
{ name: 'Empa. Carne', price: 1500, category: 'empanada' },
{ name: 'Empa. Pollo', price: 1500, category: 'empanada' },
{ name: 'Media Docena Empanadas', price: 6500, category: 'empanada' },
{ name: 'Docena Empanadas', price: 13000, category: 'empanada' },
// Comidas - Panchos
{ name: 'Pancho Simple', price: 1500, category: 'pancho' },
{ name: 'Combo Pancho+Lata', price: 3000, category: 'pancho' },
// Bebidas - Gaseosas
{ name: 'Pepsi 500ml', price: 2000, category: 'gaseosa' },
{ name: 'Pepsi Lata', price: 2000, category: 'gaseosa' },
{ name: 'Pepsi 1.5L', price: 4000, category: 'gaseosa' },
{ name: '7up 500ml', price: 2000, category: 'gaseosa' },
{ name: '7up Lata', price: 2000, category: 'gaseosa' },
{ name: '7up 1.5L', price: 4000, category: 'gaseosa' },
{ name: 'Mirinda 1.5L', price: 3500, category: 'gaseosa' },
{ name: 'H2O 1.5L', price: 3500, category: 'gaseosa' },
{ name: 'Paso Toros 1.5L', price: 4000, category: 'gaseosa' },
// Bebidas - Cervezas
{ name: 'Quilmes 1L', price: 4500, category: 'cerveza' },
{ name: 'Quilmes Negra', price: 4500, category: 'cerveza' },
{ name: 'Budweiser 1L', price: 5000, category: 'cerveza' },
{ name: 'Lata Budweiser', price: 2000, category: 'cerveza' },
{ name: 'Brahma 1L', price: 4500, category: 'cerveza' },
{ name: 'Stella 1L', price: 6000, category: 'cerveza' },
{ name: 'Corona 330ml', price: 3500, category: 'cerveza' },
{ name: 'Lata Stella', price: 3000, category: 'cerveza' },

// Bebidas - Agua/Gatorade/Baggio
{ name: 'Agua Mineral 500ml', price: 1500, category: 'agua' },
{ name: 'Agua Mineral 1.5L', price: 2500, category: 'agua' },
{ name: 'AguaFrut 1.5L', price: 3500, category: 'agua' },
{ name: 'Gatorade', price: 3000, category: 'agua' },
{ name: 'Baggio 250ml', price: 600, category: 'agua' },
// Bebidas - Vinos/Jarra/Sidra
{ name: 'Nanpe Tinto', price: 4000, category: 'vino' },
{ name: 'Alma Dada', price: 8000, category: 'vino' },
{ name: 'Chacabuco Blanco', price: 8000, category: 'vino' },
{ name: 'Sidra', price: 9000, category: 'vino' },
{ name: 'Jarra Fernet', price: 8000, category: 'vino' },
{ name: 'Jarra Gancia', price: 6000, category: 'vino' },
// Postres - Ensalada de fruta
{ name: 'tiramisu', price: 2000, category: 'postre' },
{ name: 'chocotorta', price: 2500, category: 'postre' },
// Postres - Helados
{ name: 'Palito de Agua', price: 600, category: 'helado' },
{ name: 'Bomb√≥n', price: 1500, category: 'helado' },
{ name: 'Alfajor', price: 2000, category: 'helado' },
{ name: 'Cono', price: 2500, category: 'helado' },
{ name: 'Tacita', price: 2500, category: 'helado' },
{ name: 'Juguito Congelado', price: 300, category: 'helado' },
// Postres - Batidos

// Botones r√°pidos
{ name: 'Dona', price: 700, category: 'postre' },
{ name: 'Torta Frita', price: 500, category: 'postre' },

{ name: 'Jarra Hielo', price: 1000, category: 'bebida' },
{ name: 'Agua Caliente', price: 500, category: 'bebida' }
];
}
function filterSearchCompact() {
const input = document.getElementById('search-input-compact');
const query = input.value.toLowerCase().trim();
const resultsDiv = document.getElementById('search-results-compact');
if (query === '') {
resultsDiv.style.display = 'none';
return;
}
// Palabras clave para activar filtros de categor√≠a
const categoryKeywords = {
'papa': 'papas',
'pizza': 'pizza',
'vino': 'vino',
'hamburguesa': 'hamburguesa',
'sandwich': 's√°ndwich',
'tarta': 'tarta',
'empanada': 'empanada',
'pancho': 'pancho',
'gaseosa': 'gaseosa',
'cerveza': 'cerveza',
'agua': 'agua',
'helado': 'helado'
};
// Detectar si la b√∫squeda coincide con una categor√≠a
let targetCategory = null;
for (const [keyword, category] of Object.entries(categoryKeywords)) {
if (query.includes(keyword)) {
targetCategory = category;
break;
}
}
// Filtrar productos
let matches = allProductsCompact.filter(p =>
p.name.toLowerCase().includes(query) ||
(targetCategory && p.category === targetCategory)
);
// Si no hay coincidencias directas pero hay categor√≠a detectada, mostrar todos de esa categor√≠a
if (matches.length === 0 && targetCategory) {
matches = allProductsCompact.filter(p => p.category === targetCategory);
}
// Limitar resultados
matches = matches.slice(0, 10);
if (matches.length === 0) {
resultsDiv.style.display = 'none';
return;
}
resultsDiv.innerHTML = matches.map(p => `
<div onclick="agregarProd('${p.name}', ${p.price});
document.getElementById('search-input-compact').value = '';
document.getElementById('search-results-compact').style.display = 'none';"
style="
padding: 12px 20px;
cursor: pointer;
border-bottom: 1px solid rgba(0,0,0,0.05);
transition: background 0.2s;
"
onmouseover="this.style.background='rgba(0,129,201,0.1)'"
onmouseout="this.style.background=''"
>
<div style="font-weight: bold; color: var(--accent);">${p.name}</div>
<div style="font-size: 14px; color: #666;">$${p.price}</div>
</div>
`).join('');
resultsDiv.style.display = 'block';
}
// === RESTO DEL C√ìDIGO ===
function save() {
localStorage.setItem('poli_vFinal', JSON.stringify(mesas));
localStorage.setItem('poli_historial', JSON.stringify(historial));
}
function toggleTheme() {
const isDark = document.body.getAttribute('data-theme') === 'dark';
const newTheme = isDark ? 'light' : 'dark';
document.body.setAttribute('data-theme', newTheme);
const themeColor = newTheme === 'dark' ? '#121212' : '#F1F6F9';
document.querySelector('meta[name="theme-color"]').setAttribute('content', themeColor);
localStorage.setItem('theme', newTheme);
updateThemeToggleIcon();
}
function updateThemeToggleIcon() {
const isDark = document.body.getAttribute('data-theme') === 'dark';
const themeToggle = document.getElementById('theme-toggle');
if (isDark) {
themeToggle.innerHTML = '<img src="https://i.postimg.cc/1tTBYGYg/round-pushpin-1f4cd.png" alt="‚òÄÔ∏è" style="width:24px; height:24px; vertical-align:-3px;">';
} else {
themeToggle.innerHTML = 'üåô';
}
}
function crearMesa() {
const n = prompt("Nombre/Nro Mesa:");
if (!n || mesas[n]) return;
mesas[n] = { items: {}, cobrada: false, nota: "", inicio: Date.now() };
save(); renderizarMesas(); seleccionarMesa(n); toggleMenu();
}
function seleccionarMesa(n) {
if (!mesas[n]) return;
mesaActual = n;
document.getElementById('pantalla-vacia').classList.add('hidden');
document.getElementById('area-operativa').classList.remove('hidden');
document.getElementById('titulo-mesa').innerText = `Mesa: ${n}`;
document.getElementById('nombre-mesa-ticket').innerText = n;
document.getElementById('nota-input').value = mesas[n].nota || "";
// ‚úÖ Mostrar contenedor de b√∫squeda completo
document.getElementById('search-container-compact').style.display = 'block';
actualizarTicket(); renderizarMesas();
}
function agregarDeSelect(id) {
const [n, p] = document.getElementById(id).value.split(',');
agregarProd(n, parseInt(p));
// ‚úÖ Activar el bot√≥n inmediatamente
const addButton = document.getElementById(id).nextElementSibling;
if (addButton && addButton.classList.contains('add-btn')) {
    addButton.classList.add('activo');
}
}
function agregarProd(n, p) {
if (!mesaActual || mesas[mesaActual].cobrada) return;
mesas[mesaActual].items[n] = mesas[mesaActual].items[n] || { precio: p, qty: 0 };
mesas[mesaActual].items[n].qty++;
save(); actualizarTicket();
}
function cambiarQty(n, d) {
if (mesas[mesaActual].cobrada) return;
mesas[mesaActual].items[n].qty += d;
if (mesas[mesaActual].items[n].qty <= 0) delete mesas[mesaActual].items[n];
save(); actualizarTicket();
}
function guardarNota() { if (mesaActual) { mesas[mesaActual].nota = document.getElementById('nota-input').value; save(); } }
function actualizarTicket() {
const m = mesas[mesaActual];
const container = document.getElementById('lista-pedidos');
container.innerHTML = ""; let total = 0;
// Recopilar productos actuales
const productosActuales = new Set();
for (let n in m.items) {
const i = m.items[n];
const subtotal = i.precio * i.qty;
total += subtotal;
productosActuales.add(n);
container.innerHTML += `
<div class="item-pedido">
<div class="item-info">
<b>${n}</b><br><small>$${i.precio}</small>
</div>
<div class="controles">
<button class="btn-qty" onclick="cambiarQty('${n}', -1)">-</button>
<span class="qty-num">${i.qty}</span>
<button class="btn-qty" onclick="cambiarQty('${n}', 1)">+</button>
</div>
<div class="item-subtotal">$${subtotal}</div>
</div>`;
}
document.getElementById('total-precio').innerText = `$${total}`;
// ‚úÖ Actualizar estado visual de los botones "Agregar"
const selectIds = ['papas', 'hamburg', 'pizza', 'sand', 'tarta', 'empa', 'pancho', 'gaseosa', 'birra', 'agua', 'vino', 'helado', 'fruit'];
selectIds.forEach(id => {
const select = document.getElementById(`${id}-select`);
if (!select) return;
const addButton = select.nextElementSibling;
if (!addButton || !addButton.classList.contains('add-btn')) return;
// Obtener nombre del producto seleccionado
const selectedValue = select.value.split(',')[0];
// Verificar si est√° en el pedido
const isActive = productosActuales.has(selectedValue);
if (isActive) {
addButton.classList.add('activo');
} else {
addButton.classList.remove('activo');
}
});

// ‚úÖ Comportamiento especial solo para Dona y Torta Frita
const productosConCantidad = new Set(['Dona', 'Torta Frita', 'Girasoles']);

// Guardar base text
document.querySelectorAll('.fast-btn[data-product]').forEach(btn => {
  if (!btn.hasAttribute('data-base-text')) {
    btn.setAttribute('data-base-text', btn.innerHTML);
  }
});

// Actualizar visual
document.querySelectorAll('.fast-btn[data-product]').forEach(btn => {
  const productName = btn.getAttribute('data-product');
  const baseText = btn.getAttribute('data-base-text');
  const mesa = mesas[mesaActual];
  const isInPedido = mesa && mesa.items && mesa.items[productName];

  if (productosConCantidad.has(productName)) {
    // --- Dona y Torta Frita: mostrar xN, sin precio ---
    if (isInPedido) {
      const qty = mesa.items[productName].qty;
      const tempDiv = document.createElement('div');
      tempDiv.innerHTML = baseText;
      const img = tempDiv.querySelector('img');
      const imgHTML = img ? img.outerHTML : '';
      let textContent = (tempDiv.textContent || '').trim();
      if (textContent.includes('$')) {
        textContent = textContent.split('$')[0].trim();
      }
      const cleanName = textContent || productName;
      btn.innerHTML = `${imgHTML} ${cleanName} x${qty}`;
      btn.classList.add('activo');
    } else {
      btn.innerHTML = baseText;
      btn.classList.remove('activo');
    }
  } else {
    // --- Otros: solo cambiar color, mantener texto original ---
    if (isInPedido) {
      btn.classList.add('activo');
    } else {
      btn.classList.remove('activo');
    }
  }
});




const btnContainer = document.getElementById('btn-container');
if (m.cobrada) {
    btnContainer.innerHTML = `
        <button class="btn-footer" style="background:var(--accent)" onclick="reabrir()">‚Ü©Ô∏è Reabrir</button>
        <button class="btn-footer" style="background:#25D366" onclick="enviarWhatsapp()">üì± WhatsApp</button>
        <button class="btn-footer" style="background:var(--dark)" onclick="liberar()">üßπ Liberar Mesa</button>
    `;
} else {
    btnContainer.innerHTML = `
        <button class="btn-footer" style="background:var(--success)" onclick="cobrar()">üí∞ Cobrar Mesa</button>
        <button class="btn-footer" style="background:#25D366" onclick="enviarWhatsapp()">üì± WhatsApp</button>
    `;
}
}
function cobrar() {
const m = mesas[mesaActual];
m.cobrada = true;
// Calcular total
let totalMesa = 0;
for (let n in m.items) {
totalMesa += m.items[n].precio * m.items[n].qty;
}
// Guardar venta con √≠tems
const venta = {
mesa: mesaActual,
total: totalMesa,
fecha: new Date().toLocaleTimeString(),
items: m.items // ‚úÖ Incluir los productos
};
// Actualizar historial
const index = historial.findIndex(v => v.mesa === mesaActual);
if (index !== -1) {
historial[index] = venta;
} else {
historial.push(venta);
}
save();
actualizarTicket();
renderizarMesas();
}


function verCierreCaja() {
  if (historial.length === 0) {
    alert("No hay ventas para cerrar.");
    return;
  }

  // üîí Evita enviar m√°s de una vez
  if (cierreEnviado) {
    alert("‚úÖ El cierre ya fue enviado.");
    return;
  }

  const modal = document.getElementById('modal-caja');
  const detalle = document.getElementById('caja-detalle');
  let totalGral = 0;
  detalle.innerHTML = "";
  historial.forEach(v => {
    totalGral += v.total;
    detalle.innerHTML += `<div style="border-bottom:1px solid #eee; padding:8px; display:flex; justify-content:space-between">
      <span>Mesa ${v.mesa} (${v.fecha})</span><b>$${v.total}</b>
    </div>`;
  });
  document.getElementById('caja-total').innerText = "TOTAL D√çA: $" + totalGral;
  modal.classList.remove('hidden');

  // ‚úÖ Marcar como enviado ANTES de enviar
  cierreEnviado = true;

  const urlBase = 'https://script.google.com/macros/s/AKfycbyHUZGbX4JcxDraow_pRIWhU5wbxXALjzYlIdV1lkuLukRagczEn4B4ihQZjSt9Bw7Xlw/exec';
  const historialConItems = historial.map(v => ({
    mesa: v.mesa,
    total: v.total,
    fecha: v.fecha,
    items: v.items || {}
  }));
  const params = '?datos=' + encodeURIComponent(JSON.stringify(historialConItems));

  fetch(urlBase + params, { method: 'POST', mode: 'no-cors' })
    .catch(() => {
      // Si falla, permitir reintentar
      cierreEnviado = false;
    });
}




function reiniciarCaja() {
  if (confirm("¬øLimpiar historial y todas las mesas?")) {
    historial = [];
    mesas = {};
    cierreEnviado = false; // ‚Üê‚Üê‚Üê ESTA L√çNEA ES IMPORTANTE
    save();
    location.reload();
  }
}
function reabrir() { mesas[mesaActual].cobrada = false; save(); actualizarTicket(); renderizarMesas(); }
function liberar() { if(confirm("¬øLimpiar mesa?")) { delete mesas[mesaActual]; save(); location.reload(); } }
function toggleMenu() {
const sidebar = document.getElementById('sidebar');
const body = document.body;
const overlay = document.getElementById('menu-overlay');
const isOpen = sidebar.classList.contains('open');
if (isOpen) {
sidebar.classList.remove('open');
body.classList.remove('menu-open');
overlay.classList.add('hidden');
} else {
sidebar.classList.add('open');
body.classList.add('menu-open');
overlay.classList.remove('hidden');
}
}
function enviarWhatsapp() {
const m = mesas[mesaActual];
let msg = `*Poli Grupo 2 - Mesa: ${mesaActual}*
`;
let total = 0;
for (let n in m.items) {
const i = m.items[n]; msg += `- ${i.qty}x ${n}: $${i.precio * i.qty}
`; total += i.precio * i.qty;
}
if(m.nota) msg += `_Nota: ${m.nota}_
`;
msg += `*TOTAL: $${total}*`;
window.open(`https://wa.me/?text=${encodeURIComponent(msg)}`, '_blank');
}
function renderizarMesas() {
const lista = document.getElementById('lista-mesas');
lista.innerHTML = "";
for (let n in mesas) {
const m = mesas[n];
const min = Math.floor((Date.now() - m.inicio) / 60000);
let t = 0; for (let i in m.items) t += m.items[i].precio * m.items[i].qty;
lista.innerHTML += `<div class="mesa-item ${m.cobrada ? 'cobrada' : ''}" onclick="seleccionarMesa('${n}'); toggleMenu();">
<span class="tiempo-badge">‚è±Ô∏è ${min}m</span>Mesa: ${n} <br><b>$${t}</b>
</div>`;
}
}
setInterval(renderizarMesas, 30000);
window.onload = () => {
const savedTheme = localStorage.getItem('theme') || 'light';
document.body.setAttribute('data-theme', savedTheme);
const themeColor = savedTheme === 'dark' ? '#121212' : '#F1F6F9';
document.querySelector('meta[name="theme-color"]').setAttribute('content', themeColor);
renderizarMesas();
updateThemeToggleIcon();
initializeSearchCompact();

// Guardar texto base de los fast-btn con data-product
document.querySelectorAll('.fast-btn[data-product]').forEach(btn => {
  if (!btn.hasAttribute('data-base-text')) {
    btn.setAttribute('data-base-text', btn.innerHTML);
  }
});
};
</script>
</body>

</html>








